<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>First game</title>
	<script src="node_modules/phaser/dist/phaser.min.js"></script>
	<script src="assets/scripts/index.js"></script>
	<script src="assets/scripts/input.js"></script>
	<script src="assets/scripts/createPlayer.js"></script>
	<script src="assets/scripts/createLevel.js"></script>
	<script src="assets/scripts/projectiles.js"></script>
	<style type="text/css">
	body {
		margin: 0;
	}
</style>
</head>
<body>
	<script type="text/javascript">
		var game;
		window.onload = function(){
			var config = {
				type: Phaser.AUTO,
				width: 1024,
				height: 768,
				physics: {
					default: 'arcade',
					arcade: {
						gravity: {
							y: 300
						},
						debug:false
					}
				},
				scene: {
					preload: preload,
					create: create,
					update: update
				},
				my_variables :{
					test: 1
				}
			};
			game = new Phaser.Game(config);
		}
	</script>
    
    <script type="text/javascript">

    var config = {
        type: Phaser.AUTO,
        width: 1024,
        height: 768,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y:300 },
                debug:false
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };
    var player; 
    var cursors;
    var arrow; 
    var particle;
    var counter = 0; 
    var playerDirection = 1;
    var canShoot = true;
    var i = 0;   

    var game = new Phaser.Game(config);

    function preload () {

        this.load.image('arrow', 'assets/art/img/arrow.png'); 
        this.load.image('sky', '/assets/sky.png');
        this.load.image('ground','/assets/art/tiles/stone_ground_tile.png');
        this.load.image('platform','/assets/platform.png');
        this.load.spritesheet('dude', '/assets/dude.png', { frameWidth: 32, frameHeight: 48 });

        this.load.image('arc', 'assets/art/img/arc.png');
        this.load.image('particleWhiteCircle', 'assets/art/img/particleWhiteCircle.png'); 

        
    }

    function create () {
        
    cursors = this.input.keyboard.createCursorKeys();

        this.add.image(512,384,'sky').setScale(2);

        platforms = this.physics.add.staticGroup();
        particles = this.add.particles('particleWhiteCircle');
        
        createLevel1(); 

        player = this.physics.add.sprite(100, 450, 'dude');

        createPlayer(this); 
        player.setCollideWorldBounds(false);

        var arrowEmitter = particles.createEmitter({
        speed: 10, 
        scaleX: { start: 1, end: 0 },
        scaleY: { start: 0.1, end: 0 },
        gravity: false,
        });
 
        this.cameras.main.startFollow(player);
        };
         
        


        function update ()
        {
        
        counter += 1;    
        if (game.input.activePointer.isDown && canShoot)
        {
        arrow = this.physics.add.image(player.x, player.y, 'arrow');
        arrow.setCollideWorldBounds(true);
        arrow.body.setAllowGravity(false); 
        arrow.setVelocityX(800 * playerDirection);
        canShoot = false;


        var arrowEmitter = particles.createEmitter({
        speed: 10, 
        scaleX: { start: 1, end: 0 },
        scaleY: { start: 0.1, end: 0 },
        gravity: false,
         
        });
        arrowEmitter.startFollow(arrow);
        }

        if(counter > 100)
        {
            canShoot = true; 
            counter = 0; 
        }

        if (cursors.left.isDown) {
        player.setVelocityX(-160);
        player.anims.play('left', true);
        playerDirection = -1; 
        }
        else if (cursors.right.isDown) {
        player.setVelocityX(160);
        player.anims.play('right', true);
        playerDirection = 1; 
        }
    else {
    player.setVelocityX(0);
    player.anims.play('turn');
    }
        if (cursors.up.isDown && player.body.touching.down) {
        player.setVelocityY(-200);
        }

    }

</script>

</body>
</html>